Antes de comenzar con el material para la investigación reproducible, es necesario que 
aprendamos sobre algunas herramientas fundamentales, como son RStudio, Git/Github y con 
posterioridad comenzaremos a trabajar con _RMarkDown_.

# RStudio y Git/GitHub Configuración y Motivación

## Objetivos

En esta lección Ud. aprenderá:

- En que consiste la reproducibilidad computacional y por que es útil e importante. 
- Cómo el control de versiones es fundamental para la reproducibilidad computacional.
- Cómo verificar que el ambiente de RStudio esta configurado adecuadamente para el análisis.
- Cómo configurar Git.

## Investigación reproducible

Las reproducibilidad es fundamental en la ciencia, que a su vez esta basad en observaciones empíricas, 
sobre las cuales definimos modelos explicatorios.  
Reproducibilidad por su parte, envuelve todo el ciclo de vía de la ciencia, incluyendo aspectos como la 
consistencia metodológica y el tratamiento del sesgo. En este curso nos vamos a enfocar en la 
**reproducibilidad computacional**, esto entendido como la habilidad de documentar datos, análisis y 
modelos con la suficiente información para que otros investigadores sean capaces de entender e
idealmente ejecutar nuevamente, paso a paso, el procesos que llevó a producir los resultados y 
conclusiones científicas.

### ¿Qué es necesario para la reproducibilidad computacional?

El primer paso para abordar este problema es ser capaz de evaluar los datos, 
análisis y modelos con los que se sacan las conclusiones.  Considerando cuales son las 
prácticas más comunes, esto resulta bastante difícil, dado que la generalidad de los 
datos no se encuentran disponibles, la sección sobre la metodología no 
describe en detalle las aproximaciones computacionales utilizadas, 
los análisis y modelos son generalmente realizado en programas gráficos o, cuando 
se usan ambientes tipo script, el código no está disponible.

Sin embargo todos estos inconvenientes podrían ser fácilmente remediados. 
Los investigadores pueden obtener reproducibilidad computacional siguiendo 
aproximaciones de _ciencia libre_ , incluyendo pasos simples y directos para 
archivar y hacer disponible los datos y códigos, describiendo el flujo del trabajo
que permita la trazabilidad o describir la procedencia de los
resultados científicos (ej.:, @hampton_tao_2015, @munafo_manifesto_2017).

### Conceptualizando los flujos de trabajo (workflows)

El flujo del trabajo científico encapsula todos los pasos desde la 
adquisición de los datos, limpieza, transformación, integración, análisis y 
visualización.  

```{r workflow, echo=FALSE, out.width = '100%', fig.align = 'center', fig.cap = 'Scientific workflows and provenance capture the multiple steps needed to reproduce a scientific result from raw data.'}
knitr::include_graphics("images/workflow.png")
```

Workflows can range in detail from simple flowcharts (\@ref(fig:workflow))
to fully executable scripts. R scripts and python scripts are a textual form 
of a workflow, and when researchers publish specific versions of the scripts and 
data used in an analysis, it becomes far easier to repeat their computations and 
understand the provenance of their conclusions.

## Por que usar git?

### El problema con los nombres de archivos

![](images/phd_comics_final.png)

Every file in the scientific process changes.  Manuscripts are edited.
Figures get revised.  Code gets fixed when problems are discovered.  Data files
get combined together, then errors are fixed, and then they are split and 
combined again. In the course of a single analysis, one can expect thousands of
changes to files.  And yet, all we use to track this are simplistic *filenames*.  
You might think there is a better way, and you'd be right: __version control__.

Version control systems help you track all of the changes to your files, without
the spaghetti mess that ensues from simple file renaming.  In version control systems
like `git`, the system tracks not just the name of the file, but also its contents,
so that when contents change, it can tell you which pieces went where.  It tracks
which version of a file a new version came from.  So its easy to draw a graph
showing all of the versions of a file, like this one:

![](images/version-graph.png)

Version control systems assign an identifier to every version of every file, and 
track their relationships. They also allow branches in those versions, and merging
those branches back into the main line of work.  They also support having 
*multiple copies* on multiple computers for backup, and for collaboration.
And finally, they let you tag particular versions, such that it is easy to return 
to a set of files exactly as they were when you tagged them.  For example, the 
exact versions of data, code, and narrative that were used when a manuscript was 
submitted might be `R2` in the graph above.

## Revisando el ambiente de RStudio

### Versión de R

Vamos a usar `r R.version.string`, que puede ser descargada e instalada desde [CRAN](https://cran.rstudio.com). Para ver que versión tiene instaldas, ejecute este comando en la consola de RStudio:

```
R.version$version.string
```

### RStudio Version

We will be using RStudio version 1.1.463 or later, which you can download and install [here](https://www.rstudio.com/products/rstudio/download/) To check your RStudio version, run the following in your RStudio console:

```
RStudio.Version()$version
```

If the output of this does not say `1.1.463`, you should update your RStudio. Do this by selecting Help -> Check for Updates and follow the prompts.

### Package installation

Run the following lines to check that all of the packages we need for the training are installed on your computer.

```{r, eval = F}

packages <- c("devtools", "dplyr", "DT", "ggplot2", "leaflet", "roxygen2", "tidyr")
for (package in packages) { if (!(package %in% installed.packages())) { install.packages(package) } }

rm(packages) #remove variables from workspace

```

If you haven't installed all of the packages, this will automatically start installing them. If they are installed, it won't do anything.

Next, create a new R Markdown (File -> New File -> R Markdown). If you have never made an R Markdown document before, a dialog box will pop up asking if you wish to install the required packages. Click yes.


## Setting up git

If you haven't already, go to [github.com](http://github.com) and create an account. If you haven't downloaded git already, you can download it [here](https://git-scm.com/downloads).

Before using git, you need to tell it who you are, also known as setting the global options. The only way to do this is through the command line. Newer versions of RStudio have a nice feature where you can open a terminal window in your RStudio session. Do this by selecting Tools -> Terminal -> New Terminal.

A terminal tab should now be open where your console usually is. To set the global options, type the following into the command prompt, with your actual name, and press enter:

```
git config --global user.name "Your Name"
```

Next, enter the following line, with the email address you used when you created your account on github.com:

```
git config --global user.email "yourEmail@emaildomain.com"
```

Note that these lines need to be run one at a time.

Finally, check to make sure everything looks correct by entering this line, which will return the options that you have set.

```
git config --global --list
```

### Note for Windows Users

If you get "command not found" (or similar) when you try these steps through the RStudio terminal tab, you may need to set the type of terminal that gets launched by RStudio. Under some git install senerios, the git executable may not be available to the default terminal type.
